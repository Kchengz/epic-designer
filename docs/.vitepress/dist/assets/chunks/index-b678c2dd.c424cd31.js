import{N as B,cm as P,c9 as _}from"./index.fb95377d.js";import{m as D}from"./icon.vue_vue_type_script_setup_true_lang-3f9e4127.b898144b.js";import{i as j,r as C,w as E,o,c as u,d as m,F as v,E as k,e as h,v as T,u as y,a4 as S,C as U,t as I,f as A,m as q,k as L}from"../app.c1700df1.js";const F=[{label:"string",value:"string"},{label:"number",value:"number"},{label:"boolean",value:"boolean"},{label:"method",value:"method"},{label:"regexp",value:"regexp"},{label:"integer",value:"integer"},{label:"float",value:"float"},{label:"array",value:"array"},{label:"object",value:"object"},{label:"date",value:"date"},{label:"url",value:"url"},{label:"hex",value:"hex"},{label:"email",value:"email"},{label:"any",value:"any"}],N=[{label:"change",value:"change"},{label:"blur",value:"blur"}],x=["string","number","url","array","email"],M={class:"rule-item-main bg-white m-t-2 p-2 rounded border border-solid border-gray-200 hover:border-primary transition-all relative"},z={key:0,class:"flex m-t-2 first:m-0"},G={class:"attr-label",title:"\u6821\u9A8C\u65F6\u673A"},H={class:"attr-input"},J=j({__name:"ERuleItem",props:{rule:{}},emits:["change","delete","update:rule"],setup(g,{emit:f}){const p=f,s=g,l=q({get(){return s.rule},set(e){p("update:rule",e)}}),V=L("pageManager",{}),a=q(()=>Object.entries(V.funcs.value).filter(([e,r])=>typeof r=="function").map(([e])=>({label:e,value:e}))),c=[{type:"select",label:"\u6821\u9A8C\u65F6\u673A",model:"trigger",componentProps:{options:N,placeholder:"\u6821\u9A8C\u65F6\u673A",multiple:!0,mode:"multiple"}},{type:"switch",label:"\u81EA\u5B9A\u4E49\u89C4\u5219",model:"isValidator"},{type:"select",label:"\u6821\u9A8C\u51FD\u6570",model:"validator",show(){return!!l.value.isValidator},componentProps:{options:a.value,placeholder:"\u6821\u9A8C\u51FD\u6570"}},{type:"select",label:"\u7C7B\u578B",model:"type",show(){return!l.value.isValidator},componentProps:{options:F,placeholder:"\u7C7B\u578B"}},{type:"input",label:"\u6B63\u5219\u6821\u9A8C",model:"pattern",show(){return!l.value.isValidator},componentProps:{placeholder:"\u6B63\u5219\u6821\u9A8C"}},{type:"number",label:"\u5B57\u6BB5\u957F\u5EA6",model:"len",show(){var e;return x.includes((e=l.value.type)!=null?e:"")},componentProps:{min:0,placeholder:"\u5B57\u6BB5\u957F\u5EA6"}},{type:"number",label:"\u6700\u5C0F\u957F\u5EA6",model:"min",show(){var e;return x.includes((e=l.value.type)!=null?e:"")},componentProps:{min:0,placeholder:"\u6700\u5C0F\u957F\u5EA6"}},{type:"number",label:"\u6700\u5927\u957F\u5EA6",model:"max",show(){var e;return x.includes((e=l.value.type)!=null?e:"")},componentProps:{min:0,placeholder:"\u6700\u5927\u957F\u5EA6"}},{type:"input",label:"\u6821\u9A8C\u4FE1\u606F",model:"message",componentProps:{placeholder:"\u6821\u9A8C\u4FE1\u606F"}}];function w(){const e=l.value;e.isValidator?(delete e.type,delete e.pattern,delete e.len,delete e.min,delete e.max):delete e.validator,p("change",e)}function i(){p("delete")}return(e,r)=>(o(),u("div",M,[(o(),u(v,null,k(c,(t,n)=>(o(),u(v,{key:n},[!t.show||t.show()?(o(),u("div",z,[m("div",G,S(t.label),1),m("div",H,[h(y(_),{modelValue:l.value[t.model],"onUpdate:modelValue":d=>l.value[t.model]=d,componentSchema:{...t,noFormItem:!0},onChange:w},null,8,["modelValue","onUpdate:modelValue","componentSchema"])])])):U("",!0)],64))),64)),m("div",{class:"rule-btn-delete absolute top-0 right-0 transition-all w-24px h-24px cursor-pointer rounded-bl-2 flex justify-center items-center color-white",onClick:i},[h(y(D),{name:"icon-shanchu1"})])]))}}),K={class:"rule-item-main bg-white m-t-2 p-2 rounded border border-solid border-gray-200 hover:border-primary transition-all relative"},O={key:0,class:"flex m-t-2 first:m-0"},Q={class:"attr-label"},R={class:"flex-1"},X=j({__name:"index",props:{ruleType:{type:String,default:"string"},modelValue:{type:Array,default:void 0}},emits:["update:modelValue"],setup(g,{emit:f}){const p=B.getComponent("button"),s=g,l=C({required:!1,message:"\u5FC5\u586B\u9879",type:s.ruleType,trigger:["change"]}),V=[{type:"switch",label:"\u5FC5\u586B\u9879",model:"required"},{type:"select",label:"\u6821\u9A8C\u65F6\u673A",model:"trigger",show(){return!!l.value.required},componentProps:{options:N,placeholder:"\u6821\u9A8C\u65F6\u673A",multiple:!0,mode:"multiple"}},{type:"select",label:"\u7C7B\u578B",model:"type",show(){return!!l.value.required},componentProps:{options:F,placeholder:"\u7C7B\u578B"}},{type:"input",label:"\u6821\u9A8C\u4FE1\u606F",model:"message",show(){return!!l.value.required},componentProps:{placeholder:"\u6821\u9A8C\u4FE1\u606F"}}],a=C([]),c=f;E(()=>s.modelValue,r=>{if(r){if(!r)return;a.value=[],r.forEach(t=>{typeof t.required<"u"?l.value=t:a.value.push(t)})}},{immediate:!0});function w(){a.value.push({message:"",type:s.ruleType,trigger:["change"]}),i()}function i(){if(l.value.required){c("update:modelValue",P([...a.value,l.value]));return}if(a.value.length){c("update:modelValue",P(a.value));return}c("update:modelValue",void 0)}function e(r){a.value.splice(r,1),i()}return(r,t)=>(o(),u("div",null,[m("div",K,[(o(),u(v,null,k(V,(n,d)=>(o(),u(v,{key:d},[!n.show||n.show()?(o(),u("div",O,[m("div",Q,S(n.label),1),m("div",R,[h(y(_),{modelValue:l.value[n.model],"onUpdate:modelValue":b=>l.value[n.model]=b,componentSchema:{...n,noFormItem:!0},onChange:i},null,8,["modelValue","onUpdate:modelValue","componentSchema"])])])):U("",!0)],64))),64))]),(o(!0),u(v,null,k(a.value,(n,d)=>(o(),I(J,{key:d,rule:a.value[d],"onUpdate:rule":b=>a.value[d]=b,onDelete:b=>e(d),onChange:i},null,8,["rule","onUpdate:rule","onDelete"]))),128)),h(y(p),{class:"m-t-2",onClick:w},{default:T(()=>[A(" \u6DFB\u52A0\u89C4\u5219 ")]),_:1})]))}});export{X as default};
