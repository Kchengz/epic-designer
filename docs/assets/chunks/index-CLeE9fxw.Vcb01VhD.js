import{z as B,b as k,O as q}from"./index-dBLYGWys.7krGtM9u.js";import{m as F}from"./icon.vue_vue_type_script_setup_true_lang-BKjDMfHm.CAFchCcp.js";import{d as _,j as C,x as I,o,c as u,l as p,F as v,D as P,I as h,w as T,a as z,m as y,t as S,e as U,b as E,h as j,N as O}from"./framework.Bkcw4pAp.js";const D=[{label:"string",value:"string"},{label:"number",value:"number"},{label:"boolean",value:"boolean"},{label:"method",value:"method"},{label:"regexp",value:"regexp"},{label:"integer",value:"integer"},{label:"float",value:"float"},{label:"array",value:"array"},{label:"object",value:"object"},{label:"date",value:"date"},{label:"url",value:"url"},{label:"hex",value:"hex"},{label:"email",value:"email"},{label:"any",value:"any"}],N=[{label:"change",value:"change"},{label:"blur",value:"blur"}],x=["string","number","url","array","email"],$={class:"rule-item-main bg-white m-t-2 p-2 rounded border border-solid border-gray-200 hover:border-primary transition-all relative"},A={key:0,class:"flex m-t-2 first:m-0"},H={class:"epic-attr-label",title:"校验时机"},L={class:"epic-attr-input"},M=_({__name:"ERuleItem",props:{rule:{}},emits:["change","delete","update:rule"],setup(g,{emit:f}){const s=f,m=g,e=j({get(){return m.rule},set(l){s("update:rule",l)}}),V=O("pageManager",{}),a=j(()=>Object.entries(V.funcs.value).filter(([l,r])=>typeof r=="function").map(([l])=>({label:l,value:l}))),c=[{type:"select",label:"校验时机",model:"trigger",componentProps:{options:N,placeholder:"校验时机",multiple:!0,mode:"multiple"}},{type:"switch",label:"自定义规则",model:"isValidator"},{type:"select",label:"校验函数",model:"validator",show(){return!!e.value.isValidator},componentProps:{options:a.value,placeholder:"校验函数"}},{type:"select",label:"类型",model:"type",show(){return!e.value.isValidator},componentProps:{options:D,placeholder:"类型"}},{type:"input",label:"正则校验",model:"pattern",show(){return!e.value.isValidator},componentProps:{placeholder:"正则校验"}},{type:"number",label:"字段长度",model:"len",show(){return x.includes(e.value.type??"")},componentProps:{min:0,placeholder:"字段长度"}},{type:"number",label:"最小长度",model:"min",show(){return x.includes(e.value.type??"")},componentProps:{min:0,placeholder:"最小长度"}},{type:"number",label:"最大长度",model:"max",show(){return x.includes(e.value.type??"")},componentProps:{min:0,placeholder:"最大长度"}},{type:"input",label:"校验信息",model:"message",componentProps:{placeholder:"校验信息"}}];function w(){const l=e.value;l.isValidator?(delete l.type,delete l.pattern,delete l.len,delete l.min,delete l.max):delete l.validator,s("change",l)}function d(){s("delete")}return(l,r)=>(o(),u("div",$,[(o(),u(v,null,P(c,(t,n)=>(o(),u(v,{key:n},[!t.show||t.show()?(o(),u("div",A,[p("div",H,S(t.label),1),p("div",L,[h(y(q),{modelValue:e.value[t.model],"onUpdate:modelValue":i=>e.value[t.model]=i,componentSchema:{...t,noFormItem:!0},onChange:w},null,8,["modelValue","onUpdate:modelValue","componentSchema"])])])):U("",!0)],64))),64)),p("div",{class:"rule-btn-delete absolute top-0 right-0 transition-all w-24px h-24px cursor-pointer rounded-bl-2 flex justify-center items-center color-white",onClick:d},[h(y(F),{name:"icon-shanchu1"})])]))}}),G={class:"rule-item-main m-t-2 p-2 rounded border border-solid transition-all relative"},J={key:0,class:"flex m-t-2 first:m-0"},K={class:"epic-attr-label"},Q={class:"flex-1"},X=_({__name:"index",props:{ruleType:{type:String,default:"string"},modelValue:{type:Array,default:void 0}},emits:["update:modelValue"],setup(g,{emit:f}){const s=B.getComponent("button"),m=g,e=C({required:!1,message:"必填项",type:m.ruleType,trigger:["change"]}),V=[{type:"switch",label:"必填项",model:"required"},{type:"select",label:"校验时机",model:"trigger",show(){return!!e.value.required},componentProps:{options:N,placeholder:"校验时机",multiple:!0,mode:"multiple"}},{type:"select",label:"类型",model:"type",show(){return!!e.value.required},componentProps:{options:D,placeholder:"类型"}},{type:"input",label:"校验信息",model:"message",show(){return!!e.value.required},componentProps:{placeholder:"校验信息"}}],a=C([]),c=f;I(()=>m.modelValue,r=>{if(r){if(!r)return;a.value=[],r.forEach(t=>{typeof t.required<"u"?e.value=t:a.value.push(t)})}},{immediate:!0});function w(){a.value.push({message:"",type:m.ruleType,trigger:["change"]}),d()}function d(){if(e.value.required){c("update:modelValue",k([...a.value,e.value]));return}if(a.value.length){c("update:modelValue",k(a.value));return}c("update:modelValue",void 0)}function l(r){a.value.splice(r,1),d()}return(r,t)=>(o(),u("div",null,[p("div",G,[(o(),u(v,null,P(V,(n,i)=>(o(),u(v,{key:i},[!n.show||n.show()?(o(),u("div",J,[p("div",K,S(n.label),1),p("div",Q,[h(y(q),{modelValue:e.value[n.model],"onUpdate:modelValue":b=>e.value[n.model]=b,componentSchema:{...n,noFormItem:!0},onChange:d},null,8,["modelValue","onUpdate:modelValue","componentSchema"])])])):U("",!0)],64))),64))]),(o(!0),u(v,null,P(a.value,(n,i)=>(o(),E(M,{key:i,rule:a.value[i],"onUpdate:rule":b=>a.value[i]=b,onDelete:b=>l(i),onChange:d},null,8,["rule","onUpdate:rule","onDelete"]))),128)),h(y(s),{class:"m-t-2",onClick:w},{default:T(()=>[z(" 添加规则 ")]),_:1})]))}});export{X as default};
