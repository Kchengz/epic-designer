import{d as V,a2 as z,Z as x,j as U,h as B,o as i,c as k,l as b,I as C,w as P,m as v,ai as A,aj as F,N as h,F as $,D as G,b as K,n as N,M as H,e as j,ah as w}from"./framework.Bkcw4pAp.js";import{m as D}from"./icon.vue_vue_type_script_setup_true_lang-BKjDMfHm.CAFchCcp.js";import{z as _}from"./index-dBLYGWys.7krGtM9u.js";import{R as J}from"./vuedraggable.umd-Bo-O9gJ9.C2GNCwCd.js";const I=V({name:"ETreeNodeItem",__name:"treeNodeItem",props:{schema:{}},setup(y){const e=y,m=h("slots",{}),o=h("expandedKeys"),r=h("treeProps"),f=h("selectedKeys"),c=h("handleSelect"),p=B(()=>o.value.includes(e.schema.id??"")),g=V({setup(){return()=>{var s;return w("span",{class:{text:!0,hover:r.hoverKey===e.schema.id,checked:f.value.includes(e.schema.id)},onClick:()=>c(e.schema.id,e.schema)},((s=m["tree-node"])==null?void 0:s.call(m,e))??w("span",{class:"epic-text-padding"},{default:()=>{var a;return[e.schema.label??((a=_.getComponentConfingByType(e.schema.type))==null?void 0:a.defaultSchema.label),w("span",{class:"epic-node-type-text"},e.schema.type)]}}))}}});function n(){const s=e.schema.id;if(!s)return!1;o.value.includes(s)?o.value=o.value.filter(a=>a!==s):o.value.push(s)}function d(){var s;const a=e.schema.id;if(!a||!((s=e.schema.children)!=null&&s.length))return!1;o.value.push(a)}return d(),(s,a)=>{var t,l,u;return i(),k("li",{class:N(["epic-tree-node",{expanded:(t=e.schema.children)==null?void 0:t.length,"level-1":e.schema.type==="page"}])},[b("a",null,[(l=e.schema.children)!=null&&l.length&&e.schema.type!=="page"?(i(),k("span",{key:0,class:N(["icon-expanded",{expanded:p.value}]),onClick:n},[C(v(D),{name:"icon-youjiantou"})],2)):j("",!0),C(v(g))]),(u=e.schema.children)!=null&&u.length?(i(),K(R,{key:0,class:N(["epic-tree-sublist",{expanded:p.value}]),schemas:e.schema.children,"onUpdate:schemas":a[0]||(a[0]=S=>e.schema.children=S),parentSchema:e.schema},null,8,["class","schemas","parentSchema"])):j("",!0)],2)}}}),L={key:1},R=V({name:"ETreeNodes",__name:"treeNodes",props:{schemas:{},parentSchema:{}},emits:["update:schemas"],setup(y,{emit:e}){const m=h("designer"),o=h("treeProps"),r=y,f=e,c=B({get(){return r.schemas},set(n){f("update:schemas",n)}});function p(n){m.setDisableHover(!0),m.setCheckedNode(c.value[n])}function g(n){return n.type==="page"||_.getComponentConfingByType(n.type).immovable?"unmover-item":"draggable-item"}return(n,d)=>{var s,a,t;return(a=v(_).getComponentConfingByType(((s=r.parentSchema)==null?void 0:s.type)||""))!=null&&a.childImmovable?(i(),k("ul",L,[(i(!0),k($,null,G(c.value,l=>(i(),K(I,{key:l.id,schema:l},null,8,["schema"]))),128))])):(i(),K(v(J),H({key:0,modelValue:c.value,"onUpdate:modelValue":d[0]||(d[0]=l=>c.value=l),"item-key":"id","component-data":{},class:"epic-draggable-range"},{animation:200,tag:"ul",group:"tree-draggable",ghostClass:"moveing",draggable:".draggable-item",disabled:!v(o).draggable||((t=c.value[0])==null?void 0:t.type)==="page"},{onStart:d[1]||(d[1]=l=>p(l.oldIndex))}),{item:P(({element:l,index:u})=>[(i(),K(I,{class:N(g(l)),key:l.id,schema:l},null,8,["class","schema"]))]),_:1},16,["modelValue"]))}}}),M={class:"epic-tree h-full flex flex-col"},O={class:"epic-search-box px-10px py-6px"},Q={class:"epic-tree-main flex-1 overflow-auto h-0"},Z={class:"text-center pt-42px text-gray-400"},ee=V({name:"ETree",__name:"tree",props:{options:{type:Array,default:()=>[]},hoverKey:{type:String,default:""},selectedKeys:{type:Array,default:()=>[]},draggable:{type:Boolean,default:!1}},emits:["update:selectedKeys","nodeClick"],setup(y,{emit:e}){const m=z();x("slots",m);const o=_.getComponent("input"),r=U(""),f=U([]),c=y,p=e,g=B({get(){return c.selectedKeys},set(a){p("update:selectedKeys",a)}}),n=B({get(){return d(c.options,r.value)},set(a){console.log(a)}});function d(a,t){const l=[];return a.forEach(u=>{var S;if((S=u.label)!=null&&S.includes(t))l.push(u);else if(u.children){const E=d(u.children,t);if(E.length>0){const T={...u};T.children=E,l.push(T)}}}),l}function s(a,t){g.value=[a],p("nodeClick",{id:a,componentSchema:t})}return x("expandedKeys",f),x("selectedKeys",g),x("treeProps",c),x("handleSelect",s),(a,t)=>(i(),k("div",M,[b("div",O,[C(v(o),{placeholder:"搜索节点",clearable:"",allowClear:"",modelValue:r.value,"onUpdate:modelValue":t[0]||(t[0]=l=>r.value=l),value:r.value,"onUpdate:value":t[1]||(t[1]=l=>r.value=l)},{prefix:P(()=>[C(v(D),{name:"icon-chaxun"})]),_:1},8,["modelValue","value"])]),b("div",Q,[b("ul",null,[C(R,{schemas:n.value,"onUpdate:schemas":t[2]||(t[2]=l=>n.value=l)},null,8,["schemas"])]),A(b("div",Z,"没有查询到的数据",512),[[F,!n.value.length]])])]))}});export{ee as e};
