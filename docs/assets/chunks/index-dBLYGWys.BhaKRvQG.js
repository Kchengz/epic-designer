const __vite__fileDeps=["assets/chunks/index-B4P9zbh-.xo3LC6cH.js","assets/chunks/plugin-vue_export-helper-CHgC5LLL.lGy7RumW.js","assets/chunks/framework.Bj7ZzXMq.js","assets/chunks/index-CMdVTNrg.DwjuiiOx.js","assets/chunks/icon.vue_vue_type_script_setup_true_lang-BKjDMfHm.B7qh1Z_7.js","assets/chunks/index-bcBmNlLH.CL5XEE2i.js","assets/chunks/index-C_WMetn-.Cg2CmgFd.js","assets/chunks/vuedraggable.umd-Bo-O9gJ9.DAQiaosd.js","assets/chunks/commonjsHelpers-CT_km90n.D7mXbCtF.js","assets/chunks/index-BTPcnZ-D.DwQtQxGg.js","assets/chunks/index-djhb65kD.Gim4TrHE.js","assets/chunks/index-DiDIFoTk.DjQCPO1K.js","assets/chunks/index-BWX6NfOL.C0GNkeVh.js","assets/chunks/index-GQRbS2rG.B0KWTNGb.js","assets/chunks/index-BboNn6DH.DoTflVRI.js","assets/chunks/tree.vue_vue_type_script_setup_true_lang-D6yfTpn0.z1IMbHe7.js","assets/chunks/index-CLeE9fxw.CCn2SCAl.js","assets/chunks/index-Cg5BHGL-.CoyvypoN.js","assets/chunks/index-B6l_lkIJ.tOcceGLg.js","assets/chunks/index-BMZRWlcz.DpmqOY14.js","assets/chunks/outline-kAkWqpfc.BphEvT76.js","assets/chunks/attributeView-B73qPYMR.BSSFMosa.js","assets/chunks/styleView-C4uTgVoN.Cg68ooBm.js","assets/chunks/eventView-DvCh0C3T.idVl3gsa.js"],__vite__mapDeps=i=>i.map(i=>__vite__fileDeps[i]);
import{j as E,G as ae,X as D,W as je,d as re,an as te,x as N,N as Q,ak as Ge,Z as G,h as V,z as Ie,m as L,o as z,b as q,w as P,J as be,M as ce,I as U,as as we,at as _e,r as j,e as Ae,E as ze,a2 as $e,l as X,c as fe,F as Be,D as Je,bb as De,n as He,aq as se,R as ne,ao as Se,az as We,aV as Ze,aO as Ue,am as qe,k as he,au as Ye,V as ke,bc as Qe,y as Xe}from"./framework.Bj7ZzXMq.js";var Ke=Object.defineProperty,et=(e,t,n)=>t in e?Ke(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,F=(e,t,n)=>(et(e,typeof t!="symbol"?t+"":t,n),n);const J=(e,t)=>je({loader:e,loadingComponent:t,delay:80});function ve(e=10){return Math.random().toString(36).substring(2,2+e)}function tt(e){return e.charAt(0).toUpperCase()+e.slice(1)}function H(e,t=new WeakMap){if(typeof e!="object"||e===null)return e;if(t.has(e))return t.get(e);if(Array.isArray(e)){const i=e.map(o=>H(o,t));return t.set(e,i),i}const n={};return t.set(e,n),Object.keys(e).forEach(i=>{n[i]=H(e[i],t)}),n}function Jt(e){const[t]=ot([H(e)],n=>{const i={...n,id:`${n.type}_${ve(8)}`};return(i.field||i.input)&&!$.getComponentConfingByType(i.type).fixedField&&(i.field=i.id),i});return t}function K(e,t){for(const[n,i]of Object.entries(t)){const o=e==null?void 0:e[n];o&&i&&typeof o=="object"&&typeof i=="object"?K(o,i):e[n]=i}Object.keys(e).reverse().forEach(n=>{t.hasOwnProperty(n)||(Array.isArray(t)?e.splice(n,1):delete e[n])})}function xe(e,t,n=[],i=new WeakMap){const o=a=>{if(Array.isArray(a))return a.map(o);if(typeof a=="object"&&a!==null){if(i.has(a))return"[Circular]";i.set(a,!0);const s=Object.keys(a).sort(),r={};return s.forEach(c=>{n.includes(c)||(r[c]=o(a[c]))}),i.delete(a),r}else return a};return JSON.stringify(o(e))===JSON.stringify(o(t))}function nt(e,t){const n=[];let i=!1;function o(a){if(n.push(a),a.id===t&&(i=!0),!i&&a.children!=null&&a.children.length>0)for(let s=0;s<a.children.length&&(o(a.children[s]),!i);s++);if(!i&&a.slots)for(let s in a.slots)for(let r=0;r<a.slots[s].length&&(o(a.slots[s][r]),!i);r++);i||n.pop()}return e.forEach(o),i||console.error(`没有查询到id为${t}的节点`),n}function Ht(e,t){const n=e.split(".");let i=t;for(let o=0;o<n.length;o++)if(i=i[n[o]],typeof i>"u")return;return i}function Wt(e,t,n){const i=t.split(".");let o=n;i.forEach((a,s)=>{if(s===i.length-1){o[a]=e;return}o=o[a]??(o[a]={})})}function ge(e,t,n=!1,i){const o=[],a=[...e];for(;a.length;){const s=a.pop();if(s!=null&&s.children&&!i&&a.push(...s.children),s!=null&&s.slots&&!i)for(let r in s.slots)a.push(...s.slots[r]);if(t(s)&&(o.push(s),n))return s}return n?!1:o}function ot(e,t,n){const i=[...e];for(;i.length;){const o=i.pop();if(o!=null&&o.children&&!n&&i.push(...o.children),o!=null&&o.slots&&!n)for(let a in o.slots)i.push(...o.slots[a]);K(o,t(o))}return e}function Zt(e,t){const n=ge(e,i=>i.id===t,!0);if(!n)throw new Error(`没有查询到id为${t}的节点`);return n}function Ut(e,t){const n=[{type:"",children:e}];let i=0,o=null;if(ge(n,a=>{if(o=a.children??null,!o){if(a!=null&&a.slots)for(let s in a.slots){o=a.slots[s];for(let r=0;r<o.length;r++)if(o[r].id===t)return i=r,!0}return!1}for(let s=0;s<o.length;s++)if(o[s].id===t)return i=s,!0;return!1},!0),!o)throw new Error(`没有查询到id为${t}的节点`);return{list:o,schema:o[i],index:i}}function qt(e){const t={schemas:[{type:"page",id:"root",label:"页面",children:[{label:"表单",type:"form",icon:"epic-icon-daibanshixiang",labelWidth:e.config.labelWidth||100,name:"default",componentProps:{layout:e.config.layout||"horizontal",labelWidth:e.config.labelWidth||100,labelLayout:e.config.labelLayout==="flex"?"fixed":"flex",labelCol:e.config.labelCol||{span:5},wrapperCol:e.config.wrapperCol||{span:19},hideRequiredMark:e.config.hideRequiredMark||!1,colon:e.config.colon||!0,labelAlign:e.config.labelAlign||"right",size:e.config.size||"middle"},children:[],id:"form_"+ve()}],componentProps:{style:{padding:"16px"}}}],script:e.script||""};return t.schemas[0].children[0].children=ee(e.list),t}function ee(e,t){return e.map(n=>{var i,o,a;let s=n.type??"";const r=n.options??{},c=(y,u)=>{s===y&&(s=u,r.defaultValue&&(r.defaultValue=JSON.parse(r.defaultValue)))};if(c("uploadImg","upload-image"),c("uploadFile","upload-file"),s==="date"&&r.range&&(r.type="daterange",delete r.range),(s==="date"||s==="time")&&(r.valueFormat=r.format),s==="textarea"){const{minRows:y,maxRows:u}=r;r.autoSize={minRows:y,maxRows:u},delete r.minRows,delete r.maxRows}s==="number"&&!r.precision&&delete r.precision,r.width&&(r.style={width:r.width},delete r.width),s==="grid"&&(s="row",n.childImmovable=!0),t&&t.type==="grid"&&(s="col",r.span=n.span,n.key=ve());const d={label:n.label,type:s,icon:n.icon||"",field:n.model,componentProps:r,childImmovable:n.childImmovable,id:n.key};return(r.noFormItem||!r.showLabel)&&(d.noFormItem=!0,delete r.noFormItem,delete r.showLabel),r.clearable&&(r.allowClear=!0,delete r.clearable),["input","textarea","number","password","select","cascader","checkbox","radio","date","time","slider","switch","color-picker","upload-file","upload-image"].includes(s)&&(d.input=!0,((o=(i=n.rules)==null?void 0:i[0])==null?void 0:o.required)===!1&&n.rules.shift(),((a=n.rules)==null?void 0:a.length)>0&&(d.rules=n.rules)),n.list&&(d.children=ee(n.list,n)),n.columns&&(d.children=ee(n.columns,n)),n.trs&&(d.children=ee(n.trs,n)),n.tds&&(d.children=ee(n.tds,n)),d})}function le(e){return Ze()?(Ue(e),!0):!1}function it(e){let t=0,n,i;const o=()=>{t-=1,i&&t<=0&&(i.stop(),n=void 0,i=void 0)};return(...a)=>(t+=1,n||(i=We(!0),n=i.run(()=>e(...a))),le(o),n)}function Y(e){return typeof e=="function"?e():L(e)}const at=typeof window<"u"&&typeof document<"u";typeof WorkerGlobalScope<"u"&&globalThis instanceof WorkerGlobalScope;const rt=Object.prototype.toString,st=e=>rt.call(e)==="[object Object]",Oe=()=>{};function lt(e,t){function n(...i){return new Promise((o,a)=>{Promise.resolve(e(()=>t.apply(this,i),{fn:t,thisArg:this,args:i})).then(o).catch(a)})}return n}const Ne=e=>e();function ut(e=Ne){const t=E(!0);function n(){t.value=!1}function i(){t.value=!0}const o=(...a)=>{t.value&&e(...a)};return{isActive:ke(t),pause:n,resume:i,eventFilter:o}}function ct(e){return se()}function dt(...e){if(e.length!==1)return Ye(...e);const t=e[0];return typeof t=="function"?ke(Qe(()=>({get:t,set:Oe}))):E(t)}function pt(e,t,n={}){const{eventFilter:i=Ne,...o}=n;return N(e,lt(i,t),o)}function ft(e,t,n={}){const{eventFilter:i,...o}=n,{eventFilter:a,pause:s,resume:r,isActive:c}=ut(i);return{stop:pt(e,t,{...o,eventFilter:a}),pause:s,resume:r,isActive:c}}function ye(e,t=!0,n){ct()?he(e,n):t?e():ne(e)}function mt(e=!1,t={}){const{truthyValue:n=!0,falsyValue:i=!1}=t,o=qe(e),a=E(e);function s(r){if(arguments.length)return a.value=r,a.value;{const c=Y(n);return a.value=a.value===c?Y(i):c,a.value}}return o?s:[a,s]}function Yt(e,t,n){const i=N(e,(...o)=>(ne(()=>i()),t(...o)),n);return i}function Z(e){var t;const n=Y(e);return(t=n==null?void 0:n.$el)!=null?t:n}const W=at?window:void 0;function me(...e){let t,n,i,o;if(typeof e[0]=="string"||Array.isArray(e[0])?([n,i,o]=e,t=W):[t,n,i,o]=e,!t)return Oe;Array.isArray(n)||(n=[n]),Array.isArray(i)||(i=[i]);const a=[],s=()=>{a.forEach(y=>y()),a.length=0},r=(y,u,l,v)=>(y.addEventListener(u,l,v),()=>y.removeEventListener(u,l,v)),c=N(()=>[Z(t),Y(o)],([y,u])=>{if(s(),!y)return;const l=st(u)?{...u}:u;a.push(...n.flatMap(v=>i.map(p=>r(y,v,p,l))))},{immediate:!0,flush:"post"}),d=()=>{c(),s()};return le(d),d}function ht(e){return typeof e=="function"?e:typeof e=="string"?t=>t.key===e:Array.isArray(e)?t=>e.includes(t.key):()=>!0}function Te(...e){let t,n,i={};e.length===3?(t=e[0],n=e[1],i=e[2]):e.length===2?typeof e[1]=="object"?(t=!0,n=e[0],i=e[1]):(t=e[0],n=e[1]):(t=!0,n=e[0]);const{target:o=W,eventName:a="keydown",passive:s=!1,dedupe:r=!1}=i,c=ht(t);return me(o,a,d=>{d.repeat&&Y(r)||c(d)&&n(d)},s)}function de(e,t,n={}){return Te(e,t,{...n,eventName:"keydown"})}function pe(e,t,n={}){return Te(e,t,{...n,eventName:"keyup"})}function vt(){const e=E(!1),t=se();return t&&he(()=>{e.value=!0},t),e}function Me(e){const t=vt();return V(()=>(t.value,!!e()))}function gt(e,t={}){const{window:n=W}=t,i=Me(()=>n&&"matchMedia"in n&&typeof n.matchMedia=="function");let o;const a=E(!1),s=d=>{a.value=d.matches},r=()=>{o&&("removeEventListener"in o?o.removeEventListener("change",s):o.removeListener(s))},c=Xe(()=>{i.value&&(r(),o=n.matchMedia(Y(e)),"addEventListener"in o?o.addEventListener("change",s):o.addListener(s),a.value=o.matches)});return le(()=>{c(),r(),o=void 0}),a}const oe=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},ie="__vueuse_ssr_handlers__",yt=bt();function bt(){return ie in oe||(oe[ie]=oe[ie]||{}),oe[ie]}function Pe(e,t){return yt[e]||t}function wt(e){return e==null?"any":e instanceof Set?"set":e instanceof Map?"map":e instanceof Date?"date":typeof e=="boolean"?"boolean":typeof e=="string"?"string":typeof e=="object"?"object":Number.isNaN(e)?"any":"number"}const _t={boolean:{read:e=>e==="true",write:e=>String(e)},object:{read:e=>JSON.parse(e),write:e=>JSON.stringify(e)},number:{read:e=>Number.parseFloat(e),write:e=>String(e)},any:{read:e=>e,write:e=>String(e)},string:{read:e=>e,write:e=>String(e)},map:{read:e=>new Map(JSON.parse(e)),write:e=>JSON.stringify(Array.from(e.entries()))},set:{read:e=>new Set(JSON.parse(e)),write:e=>JSON.stringify(Array.from(e))},date:{read:e=>new Date(e),write:e=>e.toISOString()}},Ce="vueuse-storage";function St(e,t,n,i={}){var o;const{flush:a="pre",deep:s=!0,listenToStorageChanges:r=!0,writeDefaults:c=!0,mergeDefaults:d=!1,shallow:y,window:u=W,eventFilter:l,onError:v=m=>{console.error(m)},initOnMounted:p}=i,w=(y?ae:E)(typeof t=="function"?t():t);if(!n)try{n=Pe("getDefaultStorage",()=>{var m;return(m=W)==null?void 0:m.localStorage})()}catch(m){v(m)}if(!n)return w;const C=Y(t),g=wt(C),_=(o=i.serializer)!=null?o:_t[g],{pause:A,resume:b}=ft(w,()=>k(w.value),{flush:a,deep:s,eventFilter:l});u&&r&&ye(()=>{me(u,"storage",f),me(u,Ce,B),p&&f()}),p||f();function S(m,x){u&&u.dispatchEvent(new CustomEvent(Ce,{detail:{key:e,oldValue:m,newValue:x,storageArea:n}}))}function k(m){try{const x=n.getItem(e);if(m==null)S(x,null),n.removeItem(e);else{const h=_.write(m);x!==h&&(n.setItem(e,h),S(x,h))}}catch(x){v(x)}}function R(m){const x=m?m.newValue:n.getItem(e);if(x==null)return c&&C!=null&&n.setItem(e,_.write(C)),C;if(!m&&d){const h=_.read(x);return typeof d=="function"?d(h,C):g==="object"&&!Array.isArray(h)?{...C,...h}:h}else return typeof x!="string"?x:_.read(x)}function f(m){if(!(m&&m.storageArea!==n)){if(m&&m.key==null){w.value=C;return}if(!(m&&m.key!==e)){A();try{(m==null?void 0:m.newValue)!==_.write(w.value)&&(w.value=R(m))}catch(x){v(x)}finally{m?ne(b):b()}}}}function B(m){f(m.detail)}return w}function Re(e){return gt("(prefers-color-scheme: dark)",e)}function Ct(e={}){const{selector:t="html",attribute:n="class",initialValue:i="auto",window:o=W,storage:a,storageKey:s="vueuse-color-scheme",listenToStorageChanges:r=!0,storageRef:c,emitAuto:d,disableTransition:y=!0}=e,u={auto:"",light:"light",dark:"dark",...e.modes||{}},l=Re({window:o}),v=V(()=>l.value?"dark":"light"),p=c||(s==null?dt(i):St(s,i,a,{window:o,listenToStorageChanges:r})),w=V(()=>p.value==="auto"?v.value:p.value),C=Pe("updateHTMLAttrs",(b,S,k)=>{const R=typeof b=="string"?o==null?void 0:o.document.querySelector(b):Z(b);if(!R)return;let f;if(y&&(f=o.document.createElement("style"),f.appendChild(document.createTextNode("*,*::before,*::after{-webkit-transition:none!important;-moz-transition:none!important;-o-transition:none!important;-ms-transition:none!important;transition:none!important}")),o.document.head.appendChild(f)),S==="class"){const B=k.split(/\s/g);Object.values(u).flatMap(m=>(m||"").split(/\s/g)).filter(Boolean).forEach(m=>{B.includes(m)?R.classList.add(m):R.classList.remove(m)})}else R.setAttribute(S,k);y&&(o.getComputedStyle(f).opacity,document.head.removeChild(f))});function g(b){var S;C(t,n,(S=u[b])!=null?S:b)}function _(b){e.onChanged?e.onChanged(b,g):g(b)}N(w,_,{flush:"post",immediate:!0}),ye(()=>_(w.value));const A=V({get(){return d?p.value:w.value},set(b){p.value=b}});try{return Object.assign(A,{store:p,system:v,state:w})}catch{return A}}function Et(e={}){const{valueDark:t="dark",valueLight:n="",window:i=W}=e,o=Ct({...e,onChanged:(s,r)=>{var c;e.onChanged?(c=e.onChanged)==null||c.call(e,s==="dark",r,s):r(s)},modes:{dark:t,light:n}}),a=V(()=>o.system?o.system.value:Re({window:i}).value?"dark":"light");return V({get(){return o.value==="dark"},set(s){const r=s?"dark":"light";a.value===r?o.value="auto":o.value=r}})}function It(e,t,n={}){const{window:i=W,...o}=n;let a;const s=Me(()=>i&&"ResizeObserver"in i),r=()=>{a&&(a.disconnect(),a=void 0)},c=V(()=>Array.isArray(e)?e.map(u=>Z(u)):[Z(e)]),d=N(c,u=>{if(r(),s.value&&i){a=new ResizeObserver(t);for(const l of u)l&&a.observe(l,o)}},{immediate:!0,flush:"post"}),y=()=>{r(),d()};return le(y),{isSupported:s,stop:y}}function Qt(e,t={width:0,height:0},n={}){const{window:i=W,box:o="content-box"}=n,a=V(()=>{var u,l;return(l=(u=Z(e))==null?void 0:u.namespaceURI)==null?void 0:l.includes("svg")}),s=E(t.width),r=E(t.height),{stop:c}=It(e,([u])=>{const l=o==="border-box"?u.borderBoxSize:o==="content-box"?u.contentBoxSize:u.devicePixelContentBoxSize;if(i&&a.value){const v=Z(e);if(v){const p=i.getComputedStyle(v);s.value=Number.parseFloat(p.width),r.value=Number.parseFloat(p.height)}}else if(l){const v=Array.isArray(l)?l:[l];s.value=v.reduce((p,{inlineSize:w})=>p+w,0),r.value=v.reduce((p,{blockSize:w})=>p+w,0)}else s.value=u.contentRect.width,r.value=u.contentRect.height},n);ye(()=>{const u=Z(e);u&&(s.value="offsetWidth"in u?u.offsetWidth:t.width,r.value="offsetHeight"in u?u.offsetHeight:t.height)});const d=N(()=>Z(e),u=>{s.value=u?t.width:0,r.value=u?t.height:0});function y(){c(),d()}return{width:s,height:r,stop:y}}function At(){const e=E(1),t=E(!1),n=Et();he(()=>{Dt(n),kt(n)});const{pressSpace:i,pressShift:o,pressCtrl:a}=xt();return{canvasScale:e,pressSpace:i,pressShift:o,pressCtrl:a,disabledZoom:t,isDark:n}}function Dt(e){var t=document.querySelector("html");new Array(...t.classList).includes("dark")?e.value=!0:e.value=!1}function kt(e){var t=document.querySelector("html"),n=new MutationObserver(function(i){for(var o of i)if(o.type==="attributes"&&o.attributeName==="class"){const a=o.target;new Array(...a.classList).includes("dark")?e.value=!0:e.value=!1}});n.observe(t,{attributes:!0,attributeFilter:["class"]}),Ie(()=>{n.disconnect()})}const ue=it(At);function xt(){const e=E(!1),t=E(!1),n=E(!1);return de(" ",i=>{var o=i.target;["INPUT","TEXTAREA"].includes(o.tagName)||i.preventDefault(),e.value=!0}),pe(" ",()=>{e.value=!1}),de("Shift",i=>{i.preventDefault(),t.value=!0}),pe("Shift",()=>{t.value=!1}),de("Control",i=>{i.preventDefault(),n.value=!0}),pe("Control",()=>{n.value=!1}),{pressSpace:e,pressShift:t,pressCtrl:n}}function Xt(e){const{pressSpace:t}=ue();let n=0,i=0;function o(r){var c;n=r.x,i=r.y,(c=r.dataTransfer)==null||c.setDragImage(document.createElement("div"),0,0)}function a(r){if(r.preventDefault(),!r.x||!r.y||!t.value)return;const c=r.x-n,d=r.y-i;n=r.x,i=r.y,e.value&&(e.value.scrollTop-=d,e.value.scrollLeft-=c)}function s(){t.value=!1}return{handleElementDragStart:o,handleElementDrag:a,handleElementDragEnd:s}}function Kt(e){const{pressCtrl:t,canvasScale:n,disabledZoom:i}=ue();function o(a){if(!t.value||i.value)return;a.preventDefault();let s=0;a.deltaY<0?s=n.value+.05:s=n.value-.05,!(s>150||s<.5)&&(n.value=s)}return N(()=>n.value,a=>{e.value&&!i.value&&(e.value.style.transform=`scale(${a})`)}),{handleZoom:o,canvasScale:n}}function en(e,t=16.66){let n;function i(){o(),n=window.setInterval(e,t)}function o(){window.clearInterval(n)}return{startTimedQuery:i,stopTimedQuery:o}}function tn(e,t){let n=null;return(...i)=>{n&&clearTimeout(n),n=setTimeout(()=>{e.apply(this,i)},t)}}function nn(){const{isDark:e}=ue(),t=mt(e);return{isDark:e,toggleDark:t}}class Ot{constructor(){F(this,"initialized",E(!1)),F(this,"components",{}),F(this,"componentConfigs",{}),F(this,"baseComponentTypes",[]),F(this,"componentSchemaGroups",E([])),F(this,"hiddenComponents",[]),F(this,"componentGroupNameMap",{}),F(this,"sortedGroups",["表单","布局"]),F(this,"viewsContainers",{activitybars:ae([]),rightSidebars:ae([])}),F(this,"publicMethods",{})}component(t,n){typeof n=="function"&&(n=J(n)),this.components[t]=n}registerComponent(t){this.component(t.defaultSchema.type,t.component),t.defaultSchema.input&&(t.config.action||(t.config.action=[]),t.config.action.unshift({type:"setValue",describe:"设置值",argsConfigs:[{...t.defaultSchema,label:"设置数据",field:"0"}]},{type:"getValue",describe:"获取值"})),this.componentConfigs[t.defaultSchema.type]=t,this.computedComponentSchemaGroups()}removeComponent(t){delete this.componentConfigs[t],delete this.components[t]}setBaseComponentTypes(t){this.baseComponentTypes=t}addBaseComponentTypes(t){this.baseComponentTypes.push(t)}removeBaseComponents(){this.baseComponentTypes.forEach(t=>{this.removeComponent(t)}),this.setBaseComponentTypes([]),this.computedComponentSchemaGroups()}getComponents(){return this.components}getComponent(t){return this.components[t]}registerActivitybar(t){typeof t.component=="function"&&(t.component=J(t.component)),typeof t.visible>"u"&&(t.visible=!0);const n=this.viewsContainers.activitybars.value.findIndex(i=>i.id===t.id);n!==-1?this.viewsContainers.activitybars.value[n]=t:this.viewsContainers.activitybars.value.push(t)}getActivitybars(){return this.viewsContainers.activitybars.value}hideActivitybar(t,n="title"){const i=this.viewsContainers.activitybars.value.findIndex(o=>o[n]===t);i!==-1&&(this.viewsContainers.activitybars.value[i].visible=!1)}showActivitybar(t,n="title"){const i=this.viewsContainers.activitybars.value.findIndex(o=>o[n]===t);i!==-1&&(this.viewsContainers.activitybars.value[i].visible=!0)}registerRightSidebar(t){typeof t.component=="function"&&(t.component=J(t.component)),typeof t.visible>"u"&&(t.visible=!0);const n=this.viewsContainers.rightSidebars.value.findIndex(i=>i.id===t.id);n!==-1?this.viewsContainers.rightSidebars.value[n]=t:this.viewsContainers.rightSidebars.value.push(t)}getRightSidebars(){return this.viewsContainers.rightSidebars.value}hideRightSidebar(t,n="title"){const i=this.viewsContainers.rightSidebars.value.findIndex(o=>o[n]===t);i!==-1&&(this.viewsContainers.rightSidebars.value[i].visible=!1)}showRightSidebar(t,n="title"){const i=this.viewsContainers.rightSidebars.value.findIndex(o=>o[n]===t);i!==-1&&(this.viewsContainers.rightSidebars.value[i].visible=!0)}getComponentConfings(){return this.componentConfigs}getComponentConfingByType(t){return this.componentConfigs[t]}computedComponentSchemaGroups(){const t=[];Object.values(this.componentConfigs).forEach(n=>{if(!this.hiddenComponents.includes(n.defaultSchema.type)&&n.groupName){const i=this.componentGroupNameMap[n.groupName]??n.groupName;let o=t.findIndex(s=>s.title===i);o===-1&&(t.push({title:i,list:[]}),o=t.length-1);let a=t[o].list.findIndex(s=>s.type===n.defaultSchema.type);a!==-1?t[o].list[a]=n.defaultSchema:t[o].list.push(n.defaultSchema)}}),t.sort((n,i)=>{const o=this.sortedGroups.indexOf(n.title),a=this.sortedGroups.indexOf(i.title);return o===-1?1:a===-1?-1:o-a}),this.componentSchemaGroups.value=t}getComponentSchemaGroups(){return this.componentSchemaGroups}setComponentGroupNameMap(t,n){this.componentGroupNameMap[t]=n}clearComponentGroupNameMap(){this.componentGroupNameMap={}}setSortedGroups(t){this.sortedGroups=t,this.computedComponentSchemaGroups()}clearSortedGroups(){this.sortedGroups=[],this.computedComponentSchemaGroups()}hideComponent(t){this.hiddenComponents.push(t),this.computedComponentSchemaGroups()}showComponent(t){this.hiddenComponents=this.hiddenComponents.filter(n=>n!==t),this.computedComponentSchemaGroups()}setHideComponents(t){this.hiddenComponents=t,this.computedComponentSchemaGroups()}setInitialized(t){this.initialized.value=t}addPublicMethod(t){const n=t.methodName??t.name,i=t.method??t.handler;this.publicMethods[n]={...t,name:n,handler:i}}removePublicMethod(t){delete this.publicMethods[t]}}const $=new Ot;function Ve(){const e=E({}),t=E({}),n=E(!1),i=E([]);function o(l){return e.value[l]}function a(l,v){e.value[l]=v}function s(l){delete e.value[l]}function r(l,v=!1){const p=Object.entries($.publicMethods).reduce((w,[C,g])=>(w[C]=g.handler,w),{});try{new Function(`const epic = this;${l}`).bind({...p,getComponent:o,find:o,defineExpose:c,publicMethods:p,pluginManager:$})()}catch(w){v&&console.error("[epic-desinger：自定义函数]异常：",w)}}function c(l){l!=null&&(t.value=l)}function d(l,...v){l==null||l.forEach(p=>{var w,C,g;if(p.type==="public"&&((w=$.publicMethods[p.methodName])==null||w.handler(...v)),p.type==="custom"&&((g=(C=t.value)[p.methodName])==null||g.call(C,...v)),p.type==="component"){(p.componentId!=null&&o(p.componentId))[p.methodName](...p.args?JSON.parse(p.args):v);return}})}function y(l=!0){n.value=l}function u(l){const v=ge(l,()=>!0);i.value=v.map(p=>p.id)}return{componentInstances:e,funcs:t,isDesignMode:n,defaultComponentIds:i,getComponentInstance:o,find:o,addComponentInstance:a,removeComponentInstance:s,setMethods:r,doActions:d,setDesignMode:y,setDefaultComponentIds:u}}function Nt(){const e=E([]),t=E([]),n=E(null);let i=0;function o(r,c="插入组件"){const d=Date.now();i+150>d||(i=d,n.value!=null&&(e.value.push(n.value),t.value.splice(0,t.value.length)),n.value={type:c,componentSchema:JSON.stringify(r)},e.value.length>20&&e.value.unshift())}function a(){if(e.value.length===0)return!1;const r=e.value.pop();return n.value!=null&&t.value.push(n.value),n.value=r,JSON.parse(r.componentSchema)}function s(){if(t.value.length===0)return!1;const r=t.value.pop();return n.value!=null&&e.value.push(n.value),n.value=r,JSON.parse(r.componentSchema)}return{recordList:e,undoList:t,currentRecord:n,push:o,undo:a,redo:s}}const Ee=Nt(),Le=re({name:"ENode",__name:"node",props:{componentSchema:{},modelValue:{},ruleField:{},resetFormData:{},name:{}},emits:["update:modelValue","change"],setup(e,{emit:t}){const{proxy:n}=se(),i=e;let o=te(H(i.componentSchema));N(()=>i.componentSchema,h=>{xe(o,h,["children"])||K(o,H(h))},{deep:!0});let a=Q("formData",{});const s=Q("slots",{}),r=Q("pageManager",{}),c=Q("disabled",{value:!1}),d=Q("ruleFieldPrefix",null),y=Q("resetFormData",!1);(i.resetFormData||y)&&(a={});const u=t,l=$.getComponent("form-item"),v=E(),p=E(),w=Ge();Object.keys(w).length&&G("nodeAttrs",w);const C=ae(null),g=te({}),_=V(()=>{var h,I;return(h=o.componentProps)!=null&&h.hidden?!1:typeof o.show=="boolean"?o.show:((I=o.show)==null?void 0:I.call(o,{values:a}))??!0}),A=V(()=>{var h;const I=_.value&&((h=o.rules)==null?void 0:h.map(O=>({...O,validator:O.validator&&r.funcs.value[O.validator]})));let T=o.field;i.ruleField?T=i.ruleField:d&&o.field&&(T=H(d),T.push(o.field));const M={...o,rules:I,rule:I,field:T};return M.children&&delete M.children,M}),b=V(()=>{var h,I;const T=((h=S.value)==null?void 0:h.bindModel)??"modelValue",M={};return o.on&&Object.keys(o.on).forEach(O=>{M[`on${tt(O)}`]=(...Fe)=>r.doActions(o.on[O],...Fe)}),{...i,...o.componentProps,disabled:(c==null?void 0:c.value)||((I=o.componentProps)==null?void 0:I.disabled),bindModel:T,[`onUpdate:${T}`]:m,...M}}),S=V(()=>$.getComponentConfingByType(o.type)??null),k=()=>a[o.field??""]??i.modelValue;N(()=>v.value,()=>{R()},{immediate:!0});function R(){var h;const I=v.value||n;o.id&&I&&(o.input&&(I.setValue=m,I.getValue=()=>a[o.field]||i.modelValue),I.setAttr=(T,M)=>o.componentProps[T]=M,I.getAttr=T=>o.componentProps[T],r.addComponentInstance(o.id,I),(h=S.value)!=null&&h.defaultSchema.input&&o.noFormItem!==!0&&p.value&&r.addComponentInstance(o.id+"formItem",p.value))}function f(){var h;o.id&&(r.removeComponentInstance(o.id),(h=S.value)!=null&&h.defaultSchema.input&&o.noFormItem!==!0&&r.removeComponentInstance(o.id+"formItem"))}async function B(){var h,I,T;if(typeof((h=o.componentProps)==null?void 0:h.defaultValue)<"u"){const O=r.isDesignMode.value?(I=o.componentProps)==null?void 0:I.defaultValue:a[o.field]??((T=o.componentProps)==null?void 0:T.defaultValue);m(H(O))}if(o.type==="slot"){const O=o.slotName;if(!O)return;C.value=re({setup(){return()=>j(s,O,{componentSchema:o,model:a})}});return}const M=$.getComponent(o.type);if(!M){console.error(`组件${o.type}未注册`);return}if(typeof M=="function"){const O=await M();C.value=O.default??O}else C.value=M}function m(h){u("update:modelValue",h),u("change",h),o.field&&(a[o.field]=h)}let x=null;return N(()=>o,h=>{const I=JSON.stringify({...h,children:void 0});if(I===x)return!1;x=I,B()},{immediate:!0,deep:!0}),Ie(f),(h,I)=>{var T;const M=ze("ENode");return L(o).noFormItem!==!0&&(T=S.value)!=null&&T.defaultSchema.input&&C.value&&_.value?(z(),q(L(l),ce({key:0,ref_key:"formItemRef",ref:p},A.value),{default:P(()=>[(z(),q(be(C.value),ce({ref_key:"componentInstance",ref:v,onVnodeMounted:R},{...b.value,...g,[b.value.bindModel]:k()}),{node:P(O=>[U(M,we(_e(O)),null,16)]),"edit-node":P(()=>[j(h.$slots,"edit-node")]),_:3},16))]),_:3},16)):C.value&&_.value?(z(),q(be(C.value),ce({key:1,onVnodeMounted:R,ref_key:"componentInstance",ref:v,model:L(a)},{...b.value,...g,[b.value.bindModel]:k()}),{node:P(O=>[U(M,we(_e(O)),null,16)]),"edit-node":P(()=>[j(h.$slots,"edit-node")]),_:3},16,["model"])):Ae("",!0)}}}),Tt={key:0,class:"epic-loading-box"},Mt={class:"epic-builder-main"},Pt={class:"epic-loading-box"},on=re({__name:"builder",props:{pageSchema:{},disabled:{type:Boolean}},emits:["ready"],setup(e,{expose:t,emit:n}){const i=J(()=>D(()=>import("./index-B4P9zbh-.xo3LC6cH.js"),__vite__mapDeps([0,1,2]))),o=Ve(),a=n,s=$e(),r=E({}),c=E(!1),d=e,y=te({schemas:[]});N(()=>d.pageSchema,g=>{K(y,g)},{immediate:!0,deep:!0}),N(()=>y.script,g=>{g&&g!==""&&o.setMethods(g,!0)},{immediate:!0}),G("slots",s),G("pageManager",o),G("forms",r),G("pageSchema",y),G("disabled",V(()=>d.disabled));function u(g="default"){return new Promise(async(_,A)=>{var b;if(!c.value){const R=N(c,async()=>{R(),_(await u(g))});return}const S=(b=r.value)==null?void 0:b[g];if(!S)return A(`表单 [name=${g}] 不存在`),!1;const k=H(await S.getData());_(k)})}function l(g="default"){return new Promise(async(_,A)=>{var b;if(!c.value){const k=N(c,async()=>{k(),_(await l(g))});return}const S=(b=r.value)==null?void 0:b[g];if(!S)return A(`表单 [name=${g}] 不存在`),!1;try{await S.validate();const k=await S.getData();_(k)}catch(k){A(k)}})}function v(g,_="default"){var A;if(!c.value){const S=N(c,()=>{S(),v(g,_)});return}const b=(A=r.value)==null?void 0:A[_];if(!b)return console.error(`表单 [name=${_}] 不存在`),!1;b.setData(g)}function p(g="default"){return new Promise(async(_,A)=>{var b;if(!c.value){const k=N(c,async()=>{k(),_(await p(g))});return}const S=(b=r.value)==null?void 0:b[g];if(!S)return A(`表单 [name=${g}] 不存在`),!1;_(S)})}const{proxy:w}=se();function C(){ne(()=>{c.value=!0,a("ready",o),w&&o.addComponentInstance("builder",w)})}return t({ready:c,getData:u,setData:v,validate:l,getFormInstance:p}),(g,_)=>L($).initialized.value?(z(),q(De,{key:1,onResolve:C},{default:P(()=>[X("div",Mt,[(z(!0),fe(Be,null,Je(y.schemas,(A,b)=>(z(),q(L(Le),{key:b,componentSchema:A},null,8,["componentSchema"]))),128))])]),fallback:P(()=>[X("div",Pt,[U(L(i))])]),_:1})):(z(),fe("div",Tt))}}),Rt={key:0,class:"epic-loading-box"},Vt={class:"epic-designer-main"},Lt={class:"epic-header-container"},Ft={class:"epic-loading-box"},an=re({__name:"designer",props:{disabledZoom:{type:Boolean,default:!1},hiddenHeader:{type:Boolean,default:!1},lockDefaultSchemaEdit:{type:Boolean,default:!1},title:{default:"EpicDesigner默认项目"},defaultSchema:{default:()=>({schemas:[{type:"page",id:"root",label:"页面",children:[],componentProps:{style:{padding:"16px"}}}],script:`const { defineExpose, find } = epic;

function test (){
    console.log('test')
}

// 通过defineExpose暴露的函数或者属性
defineExpose({
 test 
})`})}},emits:["ready","save","reset","toggleDeviceMode"],setup(e,{expose:t,emit:n}){const i=J(()=>D(()=>import("./index-CMdVTNrg.DwjuiiOx.js"),__vite__mapDeps([3,4,2]))),o=J(()=>D(()=>import("./index-bcBmNlLH.CL5XEE2i.js"),__vite__mapDeps([5,4,2]))),a=J(()=>D(()=>import("./index-C_WMetn-.Cg2CmgFd.js"),__vite__mapDeps([6,2,4,7,8]))),s=J(()=>D(()=>import("./index-BTPcnZ-D.DwQtQxGg.js"),__vite__mapDeps([9,2,4]))),r=J(()=>D(()=>import("./index-B4P9zbh-.xo3LC6cH.js"),__vite__mapDeps([0,1,2]))),c=Ve(),d=e;c.setDesignMode(),c.setDefaultComponentIds(d.defaultSchema.schemas);const y=n,u=te({checkedNode:null,hoverNode:null,disableHover:!1,matched:[]}),l=te({schemas:[],script:d.defaultSchema.script}),{disabledZoom:v}=ue();N(()=>d.disabledZoom,f=>{v.value=f},{immediate:!0}),N(()=>l.script,f=>{f&&f!==""&&c.setMethods(f)},{immediate:!0}),G("pageSchema",l),G("pageManager",c),G("designerProps",V(()=>d)),G("designer",{setCheckedNode:w,setHoverNode:C,setDisableHover:_,handleToggleDeviceMode:R,reset:S,state:u});function p(){l.schemas=H(d.defaultSchema.schemas),w(l.schemas[0]),Ee.push(l.schemas,"初始化撤销功能")}async function w(f=l.schemas[0]){u.checkedNode=f,u.matched=nt(l.schemas,f.id)}async function C(f=null){var B;if(!f||u.disableHover)return u.hoverNode=null,!1;if((f==null?void 0:f.id)===((B=u.hoverNode)==null?void 0:B.id))return!1;u.hoverNode=f}function g(){ne(()=>{y("ready",{pageManager:c})})}async function _(f=!1){u.disableHover=f}function A(f){K(l,f)}function b(){return Se(l)}function S(){xe(l.schemas,d.defaultSchema.schemas)&&l.script===d.defaultSchema.script||(K(l.schemas,d.defaultSchema.schemas),l.script=d.defaultSchema.script,w(l.schemas[0]),Ee.push(l.schemas,"重置操作"),y("reset",l))}function k(){y("save",Se(l))}function R(f){y("toggleDeviceMode",f)}return p(),t({setData:A,getData:b,reset:S}),(f,B)=>L($).initialized.value?(z(),q(De,{key:1,onResolve:g},{default:P(()=>[X("div",Vt,[X("div",Lt,[j(f.$slots,"header",{},()=>[d.hiddenHeader?Ae("",!0):(z(),q(L(i),{key:0,onSave:k},{header:P(()=>[j(f.$slots,"header-prefix")]),prefix:P(()=>[j(f.$slots,"header-prefix")]),title:P(()=>[j(f.$slots,"header-title")]),"right-prefix":P(()=>[j(f.$slots,"header-right-prefix")]),"right-action":P(()=>[j(f.$slots,"header-right-action")]),"right-suffix":P(()=>[j(f.$slots,"header-right-suffix")]),_:3}))])]),X("div",{class:He(["epic-split-view-container",{"hidden-header":f.hiddenHeader}])},[U(L(o)),U(L(a)),U(L(s))],2)])]),fallback:P(()=>[X("div",Ft,[U(L(r))])]),_:3})):(z(),fe("div",Rt))}}),jt={component:async()=>await D(()=>import("./index-djhb65kD.Gim4TrHE.js").then(e=>e.i),__vite__mapDeps([10,2,1])),defaultSchema:{label:"代码编辑器",type:"monacoEditor",field:"monacoEditor",icon:"epic-icon-write",input:!0},config:{attribute:[{label:"字段名",type:"input",field:"field"},{label:"标题",type:"input",field:"label"},{label:"默认值",type:"monacoEditor",field:"componentProps.defaultValue"}]},bindModel:"model-value"},Gt={component:async()=>await D(()=>import("./index-DiDIFoTk.DjQCPO1K.js"),__vite__mapDeps([11,2])),defaultSchema:{label:"页面",type:"page",componentProps:{},children:[]},config:{attribute:[{label:"页面名称",type:"input",componentProps:{placeholder:"请输入"},field:"name"}]}};function zt(e){e.component("EInputSize",async()=>await D(()=>import("./index-BWX6NfOL.C0GNkeVh.js"),__vite__mapDeps([12,2]))),e.component("EColEditor",async()=>await D(()=>import("./index-GQRbS2rG.B0KWTNGb.js"),__vite__mapDeps([13,4,2]))),e.component("EActionEditor",async()=>await D(()=>import("./index-BboNn6DH.DoTflVRI.js"),__vite__mapDeps([14,2,4,7,8,15]))),e.component("ERuleEditor",async()=>await D(()=>import("./index-CLeE9fxw.CCn2SCAl.js"),__vite__mapDeps([16,4,2]))),e.component("EOptionsEditor",async()=>await D(()=>import("./index-Cg5BHGL-.CoyvypoN.js"),__vite__mapDeps([17,2,7,8,4]))),e.component("ENode",async()=>await D(()=>Promise.resolve().then(()=>$t),void 0)),e.registerActivitybar({id:"component_view",title:"组件",icon:"epic-icon-mokuai_1",component:async()=>await D(()=>import("./index-B6l_lkIJ.tOcceGLg.js"),__vite__mapDeps([18,2,7,8,4]))}),e.registerActivitybar({id:"sound_code_view",title:"源码",icon:"epic-icon-daima1",component:async()=>await D(()=>import("./index-BMZRWlcz.DpmqOY14.js"),__vite__mapDeps([19,2]))}),e.registerActivitybar({id:"outline_view",title:"大纲",icon:"epic-icon-juxingkaobei",component:async()=>await D(()=>import("./outline-kAkWqpfc.BphEvT76.js"),__vite__mapDeps([20,2,15,4,7,8]))}),e.registerRightSidebar({id:"attribute_view",title:"属性",component:async()=>await D(()=>import("./attributeView-B73qPYMR.BSSFMosa.js"),__vite__mapDeps([21,2]))}),e.registerRightSidebar({id:"style_view",title:"样式",component:async()=>await D(()=>import("./styleView-C4uTgVoN.Cg68ooBm.js"),__vite__mapDeps([22,2]))}),e.registerRightSidebar({id:"event_view",title:"事件",component:async()=>await D(()=>import("./eventView-DvCh0C3T.idVl3gsa.js"),__vite__mapDeps([23,2]))}),[jt,Gt].forEach(t=>{e.registerComponent(t)})}zt($);const $t=Object.freeze(Object.defineProperty({__proto__:null,default:Le},Symbol.toStringTag,{value:"Module"}));export{It as A,Ee as E,Jt as H,xe as I,Ht as J,Zt as K,Le as O,qt as Q,Wt as U,Yt as X,Qt as Y,Ut as Z,K as a,H as b,Kt as e,Xt as j,tn as n,nn as o,an as r,on as s,en as t,ue as u,ve as v,$ as z};
